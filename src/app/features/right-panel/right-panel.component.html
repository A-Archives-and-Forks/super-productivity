<better-drawer-container
  (wasClosed)="close()"
  [isOpen]="isOpen() && !layoutService.isXs()"
  [sideWidth]="40"
  [sideWidthPx]="panelWidth()"
  [class.resizing]="isResizing()"
  [@.disabled]="isResizing()"
>
  <ng-container better-drawer-content>
    <ng-content></ng-content>
  </ng-container>

  <ng-container better-drawer-side>
    @if (isOpen()) {
      <div class="right-panel">
        <!-- Resize Handle (only show in side mode when open) -->
        @if (!layoutService.isXs()) {
          <div
            class="resize-handle"
            (mousedown)="onResizeStart($event)"
            [attr.aria-label]="'Resize right panel'"
            role="separator"
          ></div>
          <div
            class="edge-close-handle"
            role="button"
            tabindex="0"
            [attr.aria-label]="'Close right panel'"
            (click)="close()"
            (keydown.enter)="close()"
            (keydown.space)="close()"
            matRipple
            [matRippleDisabled]="isResizing()"
          >
            <mat-icon>chevron_right</mat-icon>
          </div>
        }

        @if (panelContent() === 'ISSUE_PANEL') {
          <issue-panel [@slideInFromRight]></issue-panel>
        } @else if (panelContent() === 'NOTES') {
          <notes [@slideInFromRight]></notes>
        } @else if (panelContent() === 'TASK_VIEW_CUSTOMIZER_PANEL') {
          <task-view-customizer-panel [@slideInFromRight]></task-view-customizer-panel>
        } @else if (panelContent() === 'PLUGIN') {
          @for (key of pluginPanelKeys(); track key) {
            <plugin-panel-container [@slideInFromRight]></plugin-panel-container>
          }
          <!-- Task content comes last so we can avoid an extra effect to unset selected task -->
        } @else {
          @if (selectedTaskWithDelayForNone(); as task) {
            <task-detail-panel
              [@taskDetailPanelTaskChange]="task.id"
              [@.disabled]="isDisableTaskPanelAni()"
              [task]="task"
            ></task-detail-panel>
          }
        }
      </div>
    }
  </ng-container>
</better-drawer-container>
