<h1 mat-dialog-title>{{ T.F.SYNC.D_CONFLICT.TITLE | translate }}</h1>

<mat-dialog-content>
  <div [innerHTML]="T.F.SYNC.D_CONFLICT.TEXT | translate"></div>

  <table>
    <thead>
      <tr>
        <th></th>
        <th colspan="2">{{ T.F.SYNC.D_CONFLICT.TIMESTAMP | translate }}</th>
        <th>{{ T.F.SYNC.D_CONFLICT.LAMPORT_CLOCK | translate }}</th>
      </tr>
    </thead>
    <tr
      [class.isHighlight]="isHighlightRemote"
      [matTooltip]="remoteLastUpdateAction || ''"
    >
      <td>{{ T.F.SYNC.D_CONFLICT.REMOTE | translate }}</td>
      <td>{{ remoteDate | date: 'shortDate' }}</td>
      <td>{{ remoteTime | date: 'shortTime' }}</td>
      <td [matTooltip]="remoteLamport">{{ shortenLamport(remoteLamport) }}</td>
    </tr>
    <tr
      [class.isHighlight]="isHighlightLocal"
      [matTooltip]="localLastUpdateAction || ''"
    >
      <td>{{ T.F.SYNC.D_CONFLICT.LOCAL | translate }}</td>
      <td>{{ localDate | date: 'shortDate' }}</td>
      <td>{{ localTime | date: 'shortTime' }}</td>
      <td [matTooltip]="localLamport">{{ shortenLamport(localLamport) }}</td>
    </tr>
    <tr [matTooltip]="lastSyncedAction || ''">
      <td>{{ T.F.SYNC.D_CONFLICT.LOCAL_REMOTE | translate }}</td>
      <td>{{ lastDate ? (lastDate | date: 'shortDate') : 'Never' }}</td>
      <td>{{ lastTime ? (lastTime | date: 'shortTime') : '-' }}</td>
      <td [matTooltip]="lastSyncedLamport">
        {{ shortenLamport(lastSyncedLamport) ?? '-' }}
      </td>
    </tr>
  </table>

  <!-- Vector Clock Debug Information -->
  @if (localVectorClock || remoteVectorClock) {
    <h3>Vector Clock Debug Information</h3>
    <table>
      <thead>
        <tr>
          <th></th>
          <th>Vector Clock</th>
        </tr>
      </thead>
      <tr>
        <td>{{ T.F.SYNC.D_CONFLICT.REMOTE | translate }}</td>
        <td [matTooltip]="getVectorClockString(remoteVectorClock)">
          {{ getVectorClockString(remoteVectorClock) }}
        </td>
      </tr>
      <tr>
        <td>{{ T.F.SYNC.D_CONFLICT.LOCAL | translate }}</td>
        <td [matTooltip]="getVectorClockString(localVectorClock)">
          {{ getVectorClockString(localVectorClock) }}
        </td>
      </tr>
      <tr>
        <td>Last Synced</td>
        <td [matTooltip]="getVectorClockString(lastSyncedVectorClock)">
          {{ getVectorClockString(lastSyncedVectorClock) }}
        </td>
      </tr>
      <tr>
        <td>Comparison Result</td>
        <td>
          <strong>{{ getVectorClockComparisonLabel() }}</strong>
        </td>
      </tr>
    </table>
  }
</mat-dialog-content>

<mat-dialog-actions align="end">
  <div class="wrap-buttons">
    <button
      (click)="close()"
      color="primary"
      mat-button
    >
      {{ T.G.CANCEL | translate }}
    </button>
    <button
      (click)="close('USE_REMOTE')"
      color="primary"
      mat-stroked-button
    >
      <mat-icon>file_download</mat-icon>
      {{ T.F.SYNC.D_CONFLICT.USE_REMOTE | translate }}
    </button>
    <button
      (click)="close('USE_LOCAL')"
      color="primary"
      mat-stroked-button
    >
      <mat-icon>file_upload</mat-icon>
      {{ T.F.SYNC.D_CONFLICT.USE_LOCAL | translate }}
    </button>
  </div>
</mat-dialog-actions>
